!function(a){"use strict";function c(){return d()+d()+"-"+d()+"-"+d()+"-"+d()+"-"+d()+d()+d()}function d(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}function h(a){var c=window.location.href;return!(!a.match(/^(https?):\/\/(www\.)?youtube\.com\/watch.*v=([a-zA-Z0-9_-]+)/i)&&!a.match(/^(https?):\/\/(www\.)?youtu\.be\/([a-zA-Z0-9_-]+)/i))&&{embed:c+"/youtube.html?youtube="+a}}function i(a,b){var c=document.createElement("a");c.href=a;var d=c.href.slice(0,c.href.indexOf(":"));return b.indexOf(d)>-1}function j(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function k(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function l(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function m(b,c){c?a(".editable_text:not(:has(.editable_input))",b).map(function(){var b=this.innerText,c=document.createElement("textarea");return c.classList.add("editable_input"),c.setAttribute("tabindex","-1"),c.setAttribute("rows","1"),c.value=b,b||this.classList.add("empty"),a(this).empty().append(c),autosize(c),c}):a(".editable_text > .editable_input",b).map(function(){var b=this.value,c=this.parentNode;return a(c).empty().text(b),c})}function v(a,b,c){Materialize.toast(a,b,c)}function w(){return a.active}function x(){0===w()&&a("#form-container").show();var b=c(),d=Quill.import("blots/block/embed"),q=(Quill.import("parchment"),Quill.import("delta")),r=Quill.import("modules/keyboard"),s=function(a){function b(a,c){j(this,b);var d=k(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a));d.domWrapper=document.createElement("div"),d.domWrapper.classList.add("figure_wrapper"),d.domNode.appendChild(d.domWrapper),setTimeout(function(){m(d.domNode)},1);return c.embed&&d.appendIframeNode(c.embed),d}return l(b,a),o(b,null,[{key:"create",value:function(a){var c=p(b.__proto__||Object.getPrototypeOf(b),"create",this).call(this,a);return c.setAttribute("contenteditable","false"),c}}]),o(b,[{key:"appendIframeNode",value:function(a){var b=document.createElement("div"),c=document.createElement("div"),d=document.createElement("iframe");return b.classList.add("iframe_wrap"),b.appendChild(c),c.classList.add("iframe_helper"),c.classList.add("video-container"),c.style.paddingTop="0",c.appendChild(d),d.setAttribute("src",this.sanitize(a)),d.setAttribute("width","558"),d.setAttribute("height","498"),d.setAttribute("frameborder","0"),d.setAttribute("allowtransparency","true"),d.setAttribute("allowfullscreen","true"),d.setAttribute("scrolling","no"),this.domWrapper.appendChild(b),b}},{key:"sanitize",value:function(a){return i(a,["http","https","data"])?a:"//:0"}},{key:"_index",value:function(a,b){if(a===this.domCaption)return 0;var c=0;return a.nodeType==a.TEXT_NODE&&(c+=b>=0?b:a.data.length),a.previousSibling?c+this._index(a.previousSibling,-1):a.parentNode?c+this._index(a.parentNode,-1):0}},{key:"_position",value:function(a,b){if(a.nodeType==a.TEXT_NODE)return b<=a.data.length?[a,b]:(b-=a.data.length,[null,b]);for(var c=a.firstChild;c;){var d=null,e=this._position(c,b),f=g(e,2);if(d=f[0],b=f[1],d)return[d,b];c=c.nextSibling}return[a,b]}},{key:"index",value:function(a,b){return 0}},{key:"position",value:function(a,b){return[this.domCursor,0]}}],[{key:"value",value:function(b){var a={},c=b.querySelector("img");c&&(a.image=c.src);var d=b.querySelector("video");d&&(a.video=d.src);var e=b.querySelector("iframe");return e&&(a.embed=e.src),a}}]),b}(d);s.blotName="blockFigure",s.tagName="div",Quill.register(s);var x=new Quill("#editor",{modules:{toolbar:[["bold","italic","underline"],["image"]],clipboard:{matchers:[["video",function(a,b){return a.src&&i(a.src,["http","https","data"])?(new q).insert({blockFigure:{video:a.src}}):new q}],["br",function(a,b){return a.classList.contains("inline")?(new q).insert({textBreak:!0}):b}]]},keyboard:{bindings:{"detect embed":{key:r.keys.ENTER,collapsed:!0,handler:function(a,b){var c=x.scroll.line(a.index),d=g(c,2),e=d[0],f=d[1];if(e){var i=e.domNode.innerText,j=i.substr(0,f),k=void 0;if(k=j.match(/(^|\s)(https?:\/\/\S+)$/)){var l=k[2];if(x.formatText(a.index-l.length,l.length,"link",l,Quill.sources.USER),!j.substr(0,f-l.length).trim().length&&"P"==e.domNode.tagName){var m=h(l);if(m){var n=e.offset(x.scroll);return x.updateContents((new q).retain(n).delete(j.length).insert({blockFigure:m}),Quill.sources.USER),!1}}}}return!0}}}}},formats:["bold","italic","underline","blockFigure"],placeholder:"Tulis ceritamu disini...",theme:"bubble"}),y=new Quill("#editor_title",{modules:{toolbar:!1,keyboard:{bindings:{tab:!1,handleEnter:{key:13,handler:function(){}},"required enter":{key:r.keys.ENTER,collapsed:!0,shiftKey:null,suffix:/^$/,handler:function(a,b){}}}}},placeholder:"Tulis judul ceritamu disini...",theme:"bubble"}),z={apiKey:"AIzaSyBAjTnEfCIzhQUVxlm-gnCePCQGrlON6MY",authDomain:"hicnstuff.firebaseapp.com",databaseURL:"https://hicnstuff.firebaseio.com",projectId:"hicnstuff",storageBucket:"hicnstuff.appspot.com",messagingSenderId:"235934309697"};firebase.initializeApp(z);var A=firebase.database().ref(),B="on_button_submit_"+b,C="#"+B;a(".btn.waves-effect.darken").attr("id",B),a(C).click(function(){var b=x.getLength(),c=y.getLength(),d=y.getText(),g=(d.hashCode(),d.replace(/[^a-z0-9+]+/gi,"-")),g=g+""+d.hashCode(),g=g.toLowerCase();if(b>4&&c>4){a(".btn.waves-effect.darken").addClass("disabled"),a(".btn.waves-effect.darken").removeAttr("id");a(".btn.waves-effect.darken").closest("div").remove(),a("#on_content_button").hide(),a.getJSON("//freegeoip.net/json/?callback=?",function(b){A.child("iniceritaku").child(g).set({local_date:t,local_time:u,date:a.now(),content:x.getContents(),title:y.getContents(),permalink:g,ip:b.ip,long:b.longitude,lat:b.latitude,kota:b.city})}),localStorage.setItem("permalink",g),setTimeout(function(){a.ajax({type:"GET",url:window.location.href,data:{ceritaku:localStorage.getItem("permalink")},success:function(a){},complete:function(b,c,d){var f=this.url,h=e("ceritaku",f);void 0!==h&&A.child("iniceritaku").child(h).on("value",function(b){null!==b.val()?(x.insertText(0,b.val().local_date+" - "+b.val().local_time+"\n\n",{bold:!0}),window.history.replaceState(null,null,window.location.pathname+"?ceritaku="+g),x.enable(!1),y.enable(!1),a("#form-container").show()):a("#form-container").hide()})}})},1500)}b<=1&&c<=1&&v("Loh kok masih kosongan semua -_-",1500,"rounded"),b<=4&&b>=2&&c<=4&&c>=2&&v("Upss terlalu pendek kawan ^-^",1500,"rounded"),b<=1&&c>4&&v("Ceritanya kok masih kosong",1500,"rounded"),b<=4&&b>=2&&c>4&&v("Ceritamu terlalu pendek kawan",1500,"rounded"),b>4&&c<=1&&v("Judulnya kok belum ada",1500,"rounded"),c<=4&&c>=2&&b>4&&v("Judulnya terlalu pendek",1500,"rounded"),c<=4&&c>=2&&b<=1&&v("Judul kependekan dan cerita masih kosong",1500,"rounded"),b<=4&&b>=2&&c<=1&&v("Cerita kependekan dan judul masih kosong",1500,"rounded")});var D=f("ceritaku");void 0!==D&&(a("#form-container").hide(),A.child("iniceritaku").child(D).on("value",function(b){if(null!==b.val()){a(".btn.waves-effect.darken").addClass("disabled"),a(".btn.waves-effect.darken").removeAttr("id");a(".btn.waves-effect.darken").closest("div").remove(),a("#on_content_button").hide(),x.setContents(b.val().content),x.insertText(0,b.val().local_date+" - "+b.val().local_time+"\n\n",{bold:!0}),y.setContents(b.val().title),x.enable(!1),y.enable(!1),a("#form-container").show()}else a("#form-container").hide()}))}a(".btn.waves-effect.darken").closest("div").clone();String.prototype.hashCode=function(){var b,c,a=0;if(0===this.length)return a;for(b=0;b<this.length;b++)c=this.charCodeAt(b),a=(a<<5)-a+c,a|=0;return a};var e=function(b,c){var g,h,d=decodeURIComponent(c),e=d.split("?"),f=e[1].split("&");for(h=0;h<f.length;h++)if(g=f[h].split("="),g[0]===b)return void 0===g[1]||g[1]},f=function(b){var e,f,c=decodeURIComponent(window.location.search.substring(1)),d=c.split("&");for(f=0;f<d.length;f++)if(e=d[f].split("="),e[0]===b)return void 0===e[1]||e[1]},g=function(){function a(a,b){var c=[],d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done)&&(c.push(g.value),!b||c.length!==b);d=!0);}catch(a){e=!0,f=a}finally{try{!d&&h.return&&h.return()}finally{if(e)throw f}}return c}return function(b,c){if(Array.isArray(b))return b;if(Symbol.iterator in Object(b))return a(b,c);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),p=function a(b,c,d){null===b&&(b=Function.prototype);var e=Object.getOwnPropertyDescriptor(b,c);if(void 0===e){var f=Object.getPrototypeOf(b);return null===f?void 0:a(f,c,d)}if("value"in e)return e.value;var g=e.get;return void 0!==g?g.call(d):void 0},q=new Date,r={weekday:"long",year:"numeric",month:"long",day:"numeric"},s={timeZone:"Asia/Jakarta",timeZoneName:"short",hour12:!1,hour:"2-digit",minute:"2-digit"};r.timeZone="Asia/Jakarta";var t=q.toLocaleDateString(["ban","id"],r),u=q.toLocaleTimeString(["ban","id"],s);a(document).ready(function(){Materialize.updateTextFields(),0!==a("p#diary_on_show").length&&x()})}(jQuery);